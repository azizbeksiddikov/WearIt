<div class="users-table-container">
    <table class="table">
      <thead>
        <tr>
          <th>User</th>
          <th>Status</th>
          <th>Points</th>
          <th>Orders</th>
        </tr>
      </thead>
      <tbody>
        <% users.forEach(user => { %>
        <tr>
          <td>
            <div class="user-info">
              <img
                src="<%= user.memberImage %>"
                alt="<%= user.memberFullName %>"
                class="user-avatar"
              />
              <div class="user-details">
                <a href="/users/<%= user._id %>" class="user-name">
                  <%= user.memberFullName %>
                </a>
                <a href="/users/<%= user._id %>" class="user-email">
                  <%= user.memberEmail %>
                </a>
              </div>
            </div>
          </td>
          <td>
            <div class="status-combobox">
              <span
                class="status-badge <%= user.memberStatus.toLowerCase() %>"
                onclick="toggleStatusOptions(this)"
              >
                <%= user.memberStatus %>
              </span>
              <div class="status-options">
                <div
                  class="status-option"
                  onclick="updateStatus('<%= user._id %>', 'ACTIVE')"
                >
                  Active
                </div>
                <div
                  class="status-option"
                  onclick="updateStatus('<%= user._id %>', 'BLOCK')"
                >
                  Blocked
                </div>
                <div
                  class="status-option"
                  onclick="updateStatus('<%= user._id %>', 'DELETE')"
                >
                  Deleted
                </div>
              </div>
            </div>
          </td>
          <td>
            <span
              class="points-badge"
              onclick="openPointsPopup('<%= user._id %>', <%= user.memberPoints %>)"
            >
              <%= user.memberPoints %> pts <i class="fas fa-pen ms-2"></i>
            </span>
          </td>
          <td>
            <span class="orders-count">
              <%= user.orders ? user.orders.length : 0 %> orders
            </span>
          </td>
        </tr>
        <% }); %>
      </tbody>
    </table>
  </div>
</div>

<!-- Points Update Modal -->
<div class="modal fade" id="pointsModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Update Points</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body">
        <form id="pointsForm">
          <input type="hidden" id="userId" />
          <div class="mb-3">
            <label for="points" class="form-label">Points</label>
            <input
              type="number"
              class="form-control"
              id="points"
              min="0"
              required
            />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
        >
          Cancel
        </button>
        <button
          type="button"
          class="btn btn-primary"
          onclick="updatePoints()"
        >
          Save Changes
        </button>
      </div>
    </div>
  </div>
</div>
</div>
